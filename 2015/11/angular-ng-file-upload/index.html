<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"> <!-- pwa meta begin --><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#000"><meta name="viewport" content="viewport-fit=cover, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="msapplication-tap-highlight" content="no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"> <!-- pwa meta end --><title>Angular使用ng-file-upload组件ajax上传文件</title><meta name="description" content=""><meta name="keywords" content="angular,ng-file-upload,文件上传"><link rel="icon" href="/assets/favicon.ico"><link rel="stylesheet" href="/assets/core.css"><link rel="canonical" href="/2015/11/angular-ng-file-upload/"><link rel="alternate" type="application/atom+xml" title="Vinny Wong's Blog" href="/feed.xml" /></head><body> <!-- search --><div class="searchform"> <a href="javascript:void(0);" class="searchicon"></a> <input type="text" id="keyword"/> <a href="javascript:void(0);" class="clear"></a><ul class="suggest"></ul></div><script src="/assets/jquery-1.9.1.min.js"></script> <script src="/assets/main.js"></script><nav class="header-nav"> <a class="page-link" href="/">HOME</a> / <a class="page-link" href="/categories/">CATEGORY</a> / <a class="page-link" href="/feed.xml">FEED</a> / <a class="page-link" href="/about/">ABOUT</a></nav><main> <noscript><style> article .footnotes { display: block; }</style></noscript><article><div class="center"><h1>Angular使用ng-file-upload组件ajax上传文件</h1><time>2015-11-23</time></div><div class="divider"></div><ul id="markdown-toc"><li><a href="#angular使用ng-file-upload组件ajax上传文件" id="markdown-toc-angular使用ng-file-upload组件ajax上传文件">Angular使用ng-file-upload组件ajax上传文件</a><ul><li><a href="#介绍" id="markdown-toc-介绍">介绍</a></li><li><a href="#使用步骤" id="markdown-toc-使用步骤">使用步骤</a></li><li><a href="#1-编写html页面代码按顺序依次引入相应类库" id="markdown-toc-1-编写html页面代码按顺序依次引入相应类库">1. 编写html页面代码，按顺序依次引入相应类库</a></li><li><a href="#2-编写appcontrollerjs文件控制层脚本" id="markdown-toc-2-编写appcontrollerjs文件控制层脚本">2. 编写AppController.js文件控制层脚本</a></li><li><a href="#3-html页面加入上传按钮并加入ng-file-upload上传指令" id="markdown-toc-3-html页面加入上传按钮并加入ng-file-upload上传指令">3. html页面加入上传按钮并加入ng-file-upload上传指令</a></li><li><a href="#4-在appcontrollerjs中编写文件选择事件代码并输出选中的文件对象看文件对象是否被输出了" id="markdown-toc-4-在appcontrollerjs中编写文件选择事件代码并输出选中的文件对象看文件对象是否被输出了">4. 在AppController.js中编写文件选择事件代码并输出选中的文件对象，看文件对象是否被输出了</a></li><li><a href="#5-在appcontrollerjs中完善请求上传代码" id="markdown-toc-5-在appcontrollerjs中完善请求上传代码">5. 在AppController.js中完善请求上传代码</a></li><li><a href="#6-编写后端uploadservletjava代码执行文件上传操作" id="markdown-toc-6-编写后端uploadservletjava代码执行文件上传操作">6. 编写后端UploadServlet.java代码执行文件上传操作</a></li></ul></li></ul><hr /><h1 id="angular使用ng-file-upload组件ajax上传文件">Angular使用ng-file-upload组件ajax上传文件</h1><h2 id="介绍">介绍</h2><p><strong>angular</strong>的<a href="https://github.com/danialfarid/ng-file-upload">ng-file-upload</a>组件是一个轻量级的ajax上传工具，主要有以下几种特性：</p><ul><li>实时更新上传文件进度，可以在上传过程中，取消或者终止</li><li>在html5环境下支持文件拖拽上传</li><li>在html5环境下支持从剪切版粘贴图像和葱浏览器页面拖拽图像</li><li>在html5环境下使用ngImgCrop改变图片大小</li><li>在html5环境下支持暂停/继续上传图片</li><li>本地验证文件大小、类型、宽度高度</li><li>显示预览你选择的缩略图图片</li><li>使用FileAPI支持老的浏览器上传</li></ul><h2 id="使用步骤">使用步骤</h2><h2 id="1-编写html页面代码按顺序依次引入相应类库">1. 编写html页面代码，按顺序依次引入相应类库</h2><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">ng-app=</span><span class="s">"UploadApp"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>Angular上传测试<span class="nt">&lt;/title&gt;</span>
    <span class="c">&lt;!-- 引入angular基本类库 --&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"js/angular.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="c">&lt;!-- 引入ng-file-upload类库 --&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"js/ng-file-upload-all.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"js/AppController.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body</span> <span class="na">ng-controller=</span><span class="s">"AppController"</span><span class="nt">&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div><h2 id="2-编写appcontrollerjs文件控制层脚本">2. 编写AppController.js文件控制层脚本</h2><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 初始化module并注入上传模块"ngFileUpload"</span>
<span class="kd">var</span> <span class="nx">uploadApp</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s2">"UploadApp"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"ngFileUpload"</span><span class="p">]);</span>
<span class="c1">// 定义controller并注入Upload对象</span>
<span class="nx">uploadApp</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s2">"AppController"</span><span class="p">,</span> <span class="p">[</span><span class="s1">'$scope'</span><span class="p">,</span> <span class="s1">'$http'</span><span class="p">,</span> <span class="s1">'Upload'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$http</span><span class="p">,</span> <span class="nx">Upload</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">Upload</span><span class="p">);</span>
<span class="p">}]);</span>
</code></pre></div></div><h2 id="3-html页面加入上传按钮并加入ng-file-upload上传指令">3. html页面加入上传按钮并加入ng-file-upload上传指令</h2><div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">ng-app=</span><span class="s">"UploadApp"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">"UTF-8"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>Angular上传测试<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"js/angular.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"js/ng-file-upload-all.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;script </span><span class="na">type=</span><span class="s">"text/javascript"</span> <span class="na">src=</span><span class="s">"js/AppController.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body</span> <span class="na">ng-controller=</span><span class="s">"AppController"</span><span class="nt">&gt;</span>
    <span class="c">&lt;!-- 增加上传按钮并加上文件选择事件 --&gt;</span>
    <span class="nt">&lt;button</span> <span class="na">ngf-select=</span><span class="s">"uploadFiles($files)"</span><span class="nt">&gt;</span>上传<span class="nt">&lt;/button&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div><h2 id="4-在appcontrollerjs中编写文件选择事件代码并输出选中的文件对象看文件对象是否被输出了">4. 在AppController.js中编写文件选择事件代码并输出选中的文件对象，看文件对象是否被输出了</h2><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// 初始化module并注入上传模块"ngFileUpload"</span>
<span class="kd">var</span> <span class="nx">uploadApp</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s2">"UploadApp"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"ngFileUpload"</span><span class="p">]);</span>
<span class="c1">// 定义controller并注入Upload对象</span>
<span class="nx">uploadApp</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s2">"AppController"</span><span class="p">,</span> <span class="p">[</span><span class="s1">'$scope'</span><span class="p">,</span> <span class="s1">'$http'</span><span class="p">,</span> <span class="s1">'Upload'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$http</span><span class="p">,</span> <span class="nx">Upload</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// 选择文件上传事件</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">uploadFiles</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">files</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">files</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}]);</span>
</code></pre></div></div><h2 id="5-在appcontrollerjs中完善请求上传代码">5. 在AppController.js中完善请求上传代码</h2><div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">uploadApp</span> <span class="o">=</span> <span class="nx">angular</span><span class="p">.</span><span class="nx">module</span><span class="p">(</span><span class="s2">"UploadApp"</span><span class="p">,</span> <span class="p">[</span><span class="s2">"ngFileUpload"</span><span class="p">]);</span>
<span class="c1">// 定义controller并注入Upload对象</span>
<span class="nx">uploadApp</span><span class="p">.</span><span class="nx">controller</span><span class="p">(</span><span class="s2">"AppController"</span><span class="p">,</span> <span class="p">[</span><span class="s1">'$scope'</span><span class="p">,</span> <span class="s1">'$http'</span><span class="p">,</span> <span class="s1">'Upload'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">$scope</span><span class="p">,</span> <span class="nx">$http</span><span class="p">,</span> <span class="nx">Upload</span><span class="p">)</span> <span class="p">{</span>
    <span class="c1">// 选择文件上传事件</span>
    <span class="nx">$scope</span><span class="p">.</span><span class="nx">uploadFiles</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">files</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">files</span> <span class="o">&amp;&amp;</span> <span class="nx">files</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">Upload</span><span class="p">.</span><span class="nx">upload</span><span class="p">({</span>
                <span class="na">url</span><span class="p">:</span> <span class="s1">'/upload'</span><span class="p">,</span>
                <span class="na">data</span><span class="p">:</span> <span class="p">{</span> <span class="na">file</span><span class="p">:</span> <span class="nx">files</span> <span class="p">}</span>
            <span class="p">}).</span><span class="nx">then</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">resp</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">resp</span><span class="p">);</span>
            <span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">evt</span><span class="p">)</span> <span class="p">{</span>
                <span class="kd">var</span> <span class="nx">progressPercentage</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="mf">100.0</span> <span class="o">*</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">loaded</span> <span class="o">/</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">total</span><span class="p">);</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'progress: '</span> <span class="o">+</span> <span class="nx">progressPercentage</span> <span class="o">+</span> <span class="s1">'% '</span> <span class="o">+</span> <span class="nx">evt</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">data</span><span class="p">.</span><span class="nx">file</span><span class="p">.</span><span class="nx">name</span><span class="p">);</span>
            <span class="p">},</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">resp</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">'Error status: '</span> <span class="o">+</span> <span class="nx">resp</span><span class="p">.</span><span class="nx">status</span><span class="p">);</span>
            <span class="p">});</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}]);</span>
</code></pre></div></div><h2 id="6-编写后端uploadservletjava代码执行文件上传操作">6. 编写后端UploadServlet.java代码执行文件上传操作</h2><p>编辑web.xml添加上传处理的servlet配置段</p><div class="language-xml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span>
<span class="nt">&lt;web-app</span> <span class="na">xmlns=</span><span class="s">"http://xmlns.jcp.org/xml/ns/javaee"</span>
         <span class="na">xmlns:xsi=</span><span class="s">"http://www.w3.org/2001/XMLSchema-instance"</span>
         <span class="na">xsi:schemaLocation=</span><span class="s">"http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd"</span>
         <span class="na">version=</span><span class="s">"3.1"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;servlet&gt;</span>
        <span class="nt">&lt;servlet-name&gt;</span>UploadServlet<span class="nt">&lt;/servlet-name&gt;</span>
        <span class="nt">&lt;servlet-class&gt;</span>com.bosyun.servlet.UploadServlet<span class="nt">&lt;/servlet-class&gt;</span>
    <span class="nt">&lt;/servlet&gt;</span>
    <span class="nt">&lt;servlet-mapping&gt;</span>
        <span class="nt">&lt;servlet-name&gt;</span>UploadServlet<span class="nt">&lt;/servlet-name&gt;</span>
        <span class="nt">&lt;url-pattern&gt;</span>/upload<span class="nt">&lt;/url-pattern&gt;</span>
    <span class="nt">&lt;/servlet-mapping&gt;</span>
    <span class="nt">&lt;welcome-file-list&gt;</span>
        <span class="nt">&lt;welcome-file&gt;</span>index.html<span class="nt">&lt;/welcome-file&gt;</span>
    <span class="nt">&lt;/welcome-file-list&gt;</span>
<span class="nt">&lt;/web-app&gt;</span>
</code></pre></div></div><p>实现上传处理的servlet代码</p><div class="language-java highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">package</span> <span class="n">com</span><span class="o">.</span><span class="na">bosyun</span><span class="o">.</span><span class="na">servlet</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">org.apache.commons.fileupload.FileItem</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.commons.fileupload.FileUploadException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.commons.fileupload.disk.DiskFileItemFactory</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">org.apache.commons.fileupload.servlet.ServletFileUpload</span><span class="o">;</span>

<span class="kn">import</span> <span class="nn">javax.servlet.ServletException</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">javax.servlet.http.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.io.*</span><span class="o">;</span>
<span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>

<span class="kd">public</span> <span class="kd">class</span> <span class="nc">UploadServlet</span> <span class="kd">extends</span> <span class="n">HttpServlet</span> <span class="o">{</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doPost</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ServletException</span><span class="o">,</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="n">String</span> <span class="n">savePath</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">getServletContext</span><span class="o">().</span><span class="na">getRealPath</span><span class="o">(</span><span class="s">"/WEB-INF/upload"</span><span class="o">);</span>  <span class="c1">// 定义山川路径</span>
        <span class="n">File</span> <span class="n">file</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="n">savePath</span><span class="o">);</span>
        <span class="k">if</span> <span class="o">(!</span><span class="n">file</span><span class="o">.</span><span class="na">exists</span><span class="o">()</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">file</span><span class="o">.</span><span class="na">isDirectory</span><span class="o">())</span> <span class="n">file</span><span class="o">.</span><span class="na">mkdir</span><span class="o">();</span> <span class="c1">// bu存在则创建</span>

        <span class="c1">// 这里使用的是common-file-upload.jar</span>
        <span class="n">DiskFileItemFactory</span> <span class="n">factory</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DiskFileItemFactory</span><span class="o">();</span>
        <span class="n">ServletFileUpload</span> <span class="n">upload</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ServletFileUpload</span><span class="o">(</span><span class="n">factory</span><span class="o">);</span>
        <span class="n">upload</span><span class="o">.</span><span class="na">setHeaderEncoding</span><span class="o">(</span><span class="s">"UTF-8"</span><span class="o">);</span>
        <span class="k">if</span><span class="o">(!</span><span class="n">ServletFileUpload</span><span class="o">.</span><span class="na">isMultipartContent</span><span class="o">(</span><span class="n">request</span><span class="o">))</span> <span class="o">{</span>
            <span class="c1">// 按照传统方式获取数据</span>
            <span class="c1">// ...</span>
            <span class="k">return</span><span class="o">;</span>
        <span class="o">}</span>

        <span class="k">try</span> <span class="o">{</span>
            <span class="n">List</span><span class="o">&lt;</span><span class="n">FileItem</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="n">upload</span><span class="o">.</span><span class="na">parseRequest</span><span class="o">(</span><span class="n">request</span><span class="o">);</span>
            <span class="k">for</span><span class="o">(</span><span class="n">FileItem</span> <span class="n">item</span> <span class="o">:</span> <span class="n">list</span><span class="o">)</span> <span class="o">{</span>
                <span class="k">if</span><span class="o">(</span><span class="n">item</span><span class="o">.</span><span class="na">isFormField</span><span class="o">()){</span> <span class="c1">//如果fileitem中封装的是普通输入项的数据</span>
                    <span class="n">String</span> <span class="n">name</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="na">getFieldName</span><span class="o">();</span>
                    <span class="n">String</span> <span class="n">value</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="na">getString</span><span class="o">(</span><span class="s">"UTF-8"</span><span class="o">);</span>
                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">name</span> <span class="o">+</span> <span class="s">"="</span> <span class="o">+</span> <span class="n">value</span><span class="o">);</span>
                <span class="o">}</span><span class="k">else</span> <span class="o">{</span> <span class="c1">//如果fileitem中封装的是上传文件</span>
                    <span class="n">String</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="na">getName</span><span class="o">();</span>
                    <span class="k">if</span><span class="o">(</span><span class="n">filename</span> <span class="o">==</span> <span class="kc">null</span> <span class="o">||</span> <span class="n">filename</span><span class="o">.</span><span class="na">trim</span><span class="o">().</span><span class="na">equals</span><span class="o">(</span><span class="s">""</span><span class="o">))</span>
                        <span class="k">continue</span><span class="o">;</span>
                    <span class="n">filename</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">filename</span><span class="o">.</span><span class="na">lastIndexOf</span><span class="o">(</span><span class="s">"\\"</span><span class="o">)+</span><span class="mi">1</span><span class="o">);</span>
                    <span class="n">InputStream</span> <span class="n">in</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span>
                    <span class="n">FileOutputStream</span> <span class="n">out</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileOutputStream</span><span class="o">(</span><span class="n">savePath</span> <span class="o">+</span> <span class="s">"/"</span> <span class="o">+</span> <span class="n">filename</span><span class="o">);</span>
                    <span class="kt">byte</span> <span class="n">buffer</span><span class="o">[]</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">byte</span><span class="o">[</span><span class="mi">1024</span><span class="o">];</span>
                    <span class="kt">int</span> <span class="n">len</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
                    <span class="k">while</span><span class="o">((</span><span class="n">len</span><span class="o">=</span><span class="n">in</span><span class="o">.</span><span class="na">read</span><span class="o">(</span><span class="n">buffer</span><span class="o">))</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="o">)</span> <span class="o">{</span>
                        <span class="n">out</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">buffer</span><span class="o">,</span> <span class="mi">0</span><span class="o">,</span> <span class="n">len</span><span class="o">);</span>
                    <span class="o">}</span>
                    <span class="n">in</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
                    <span class="n">out</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
                    <span class="n">item</span><span class="o">.</span><span class="na">delete</span><span class="o">();</span>  <span class="c1">// 删除临时文件</span>
                <span class="o">}</span>
            <span class="o">}</span>
        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">FileUploadException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
        <span class="o">}</span>
    <span class="o">}</span>

    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">doGet</span><span class="o">(</span><span class="n">HttpServletRequest</span> <span class="n">request</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ServletException</span><span class="o">,</span> <span class="n">IOException</span> <span class="o">{</span>
        <span class="k">this</span><span class="o">.</span><span class="na">doPost</span><span class="o">(</span><span class="n">request</span><span class="o">,</span> <span class="n">response</span><span class="o">);</span>
    <span class="o">}</span>
<span class="o">}</span>
</code></pre></div></div><div class="divider"></div><blockquote id='by-nc-nd'><div> 版权所有，本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/">知识共享署名-非商业性使用 3.0 未本地化版本许可协议</a>进行许可。转载请注明出处：<a href="http://www.vinny.cc//2015/11/angular-ng-file-upload/" akt="">http://www.vinny.cc//2015/11/angular-ng-file-upload/</a></div></blockquote><div class="divider"></div><a class="w-search active" href="#" title="forward to search">⊙</a> <a class="w-catalog active" href="javascript:void(0);" title="open to catalog">≣</a></article><div class="page-navigation"> <a class="next" href="/2015/11/linux-sudo-file/" title="NEXT: Linux下is not in the sudoers file解决方法">&lt;&lt;</a> <span> &middot; </span> <a class="home" href="/" title="Back to Homepage">Home</a> <span> &middot; </span> <a class="prev" href="/2015/11/linux-cut-command/" title="PREV: Linux中cut命令使用详解">&gt;&gt;</a></div></main><!--<div class="footer"> --> <!-- <span class="block">Made with &hearts; using <a href="http://jekyllrb.com/">Jekyll</a> &amp; <a href="https://github.com/heiswayi/the-plain" title="The Plain theme by Heiswayi Nrird">The Plain</a> &middot; &lt;/&gt; on <a href="https://github.com/wangjunneil" title="Hosted on GitHub">GitHub</a></span> --> <!-- <span class="block"><a href="https://vinny.cc">Vinny's Blog</a> © 2018 - All Rights Reserved</span></div>--></body></html>