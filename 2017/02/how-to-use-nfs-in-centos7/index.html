<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"> <!-- pwa meta begin --><link rel="manifest" href="/manifest.json"><meta name="theme-color" content="#000"><meta name="viewport" content="viewport-fit=cover, width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"><meta name="format-detection" content="telephone=no"><meta name="msapplication-tap-highlight" content="no"> <!-- IOS不会读取manifest中的icon，用此配置进行适配 --><link rel="apple-touch-icon" href="assets/icons/icon-96x96.png"><link rel="apple-touch-icon" sizes="152x152" href="/assets/icons/icon-152x152.png"><link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/icon-180x180.png"><link rel="apple-touch-icon" sizes="167x167" href="/assets/icons/icon-167x167.png"> <!-- ios修复splash黑屏 --><link href="/assets/img/icons/apple_splash_1125.png" sizes="1125x2436" rel="apple-touch-startup-image" /><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"> <!-- pwa meta end --><title>Centos7中NFS的配置及使用方法</title><meta name="description" content=""><meta name="keywords" content="nfs"><link rel="icon" href="/assets/favicon.ico"><link rel="stylesheet" href="/assets/core.css"><link rel="canonical" href="/2017/02/how-to-use-nfs-in-centos7/"><link rel="alternate" type="application/atom+xml" title="The Jun Wong's blog" href="/feed.xml" /></head><body> <!-- 全局页面loading --><div class="loading"><div class="spinner"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div><!-- search --><div class="searchform"> <a href="javascript:void(0);" class="searchicon"></a> <input type="text" id="keyword"/> <a href="javascript:void(0);" class="clear"></a><ul class="suggest"></ul></div><script src="/assets/js/jquery-1.9.1.min.js"></script> <script src="/assets/js/main.js"></script><nav class="header-nav"> <a class="page-link" href="/">HOME</a> / <a class="page-link" href="/categories/">CATEGORY</a> / <a class="page-link" href="/feed.xml">FEED</a> <!-- <a class="page-link" href="/lab/index.html">MYLAB</a> --> / <a class="page-link" href="/about/">ABOUT</a></nav><main><article> <!-- 目录导航，在nav,js中进行渲染 --><div class="w-catalog"></div><div class="w-catalog-btn">目录</div><div class="center"><h1>Centos7中NFS的配置及使用方法</h1><time>2017-02-09</time></div><div class="divider"></div><ul id="markdown-toc"><li><a href="#安装nfs工具包" id="markdown-toc-安装nfs工具包">安装NFS工具包</a></li><li><a href="#编辑nfs配置文件" id="markdown-toc-编辑nfs配置文件">编辑NFS配置文件</a></li><li><a href="#服务端启动nfs" id="markdown-toc-服务端启动nfs">服务端启动NFS</a></li><li><a href="#客户端执行挂载" id="markdown-toc-客户端执行挂载">客户端执行挂载</a></li><li><a href="#挂载命令exportfs说明" id="markdown-toc-挂载命令exportfs说明">挂载命令exportfs说明</a></li></ul><h2 id="安装nfs工具包">安装NFS工具包</h2><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>yum <span class="nb">install</span> <span class="nt">-y</span> nfs-utils
</code></pre></div></div><blockquote><p>尽量使用<code class="highlighter-rouge">yum</code>方式安装，依赖文件的互相依赖，编译安装很麻烦。 <strong>nfs-utils</strong>包含server和client端的工具，所以nfs的服务端和客户端都需要执行此安装。</p></blockquote><h2 id="编辑nfs配置文件">编辑NFS配置文件</h2><p>编辑<code class="highlighter-rouge">vi /etc/exports</code>文件，添加共享路径及访问规则，例如：</p><div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/data *(rw,sync,no_root_squash)
</code></pre></div></div><p>上面为最简单的共享方式，共享本机<strong>/data</strong>目录，允许所有来源进行挂载读写。</p><p>配置文件中的每一行分为三个部分：</p><ol><li>共享路径，如:/root/nfs</li><li>访问来源，”*****“号表示任意，可以是一个IP地址，也可以是一个网段，如192.168.1.0/24</li><li>行为控制，括号中使用英文逗号分隔，如rw表示读写，ro只读，等参数</li></ol><blockquote><p>注意：配置行中的<strong>访问来源</strong>和<strong>行为控制</strong>中间没有空格。</p></blockquote><h2 id="服务端启动nfs">服务端启动NFS</h2><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 设置开机启动</span>
systemctl <span class="nb">enable </span>rpcbind.service
systemctl <span class="nb">enable </span>nfs-server.service

<span class="c"># 启动NFS服务</span>
systemctl start rpcbind.service
systemctl start nfs-server.service
</code></pre></div></div><p>启动好后可以使用命令<code class="highlighter-rouge">rpcinfo -p</code>和<code class="highlighter-rouge">showmount -e</code>查看是否启动和挂载成功。</p><h2 id="客户端执行挂载">客户端执行挂载</h2><div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># 设置开机运行</span>
systemctl <span class="nb">enable </span>rpcbind.service

<span class="c"># 启动RPC服务</span>
systemctl start rpcbind.service

<span class="c"># 检查NFS服务器共享路径</span>
showmount <span class="nt">-e</span> 192.168.1.100

<span class="c"># 执行挂载到本地</span>
mount <span class="nt">-t</span> nfs 192.168.1.100:/data /root/resources
</code></pre></div></div><blockquote><p>客户端执行挂载时尽量不要在目标目录中，完成后，可以使用命令<code class="highlighter-rouge">df -hP</code>或者<code class="highlighter-rouge">mount</code>查看挂载路径。</p></blockquote><h2 id="挂载命令exportfs说明">挂载命令exportfs说明</h2><p>当更改了NFS的配置文件，可以不重启服务，使用命令<code class="highlighter-rouge">exportfs -rv</code>重新读取，具体使用参数如下：</p><p>-a ： 全部挂载或者卸载 -r ： 重新挂载 -u ： 卸载某个目录 -v ： 现实共享目录</p><div class="divider"></div><blockquote id='by-nc-nd'><div> 版权所有，本作品采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/">知识共享署名-非商业性使用 3.0 未本地化版本许可协议</a>进行许可。转载请注明出处：<a href="https://www.wangjun.dev//2017/02/how-to-use-nfs-in-centos7/" akt="">https://www.wangjun.dev//2017/02/how-to-use-nfs-in-centos7/</a></div></blockquote><div class="divider"></div></article><div class="page-navigation"> <a class="next" href="/2017/02/linux-add-swap-space/" title="NEXT: Linux增加swap分区">&lt;&lt;</a> <span> &middot; </span> <a class="home" href="/" title="Back to Homepage">Home</a> <span> &middot; </span> <a class="prev" href="/2017/01/shell-pop-xterm/" title="PREV: Shell执行时弹出xterm子进程终端窗口">&gt;&gt;</a></div><!-- 书签处理 --> <script type="text/javascript" src="/assets/js/zepto.min.js"></script> <script type="text/javascript" src="/assets/js/nav.js"></script></main><!-- service worker check update bar --><div id="notification">A new version of this app is available. Click <a id="reload">here</a> to update.</div></body></html>